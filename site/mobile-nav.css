/* ==========================================================================
   MOBILE NAVIGATION - OVERRIDES & ENHANCEMENTS
   This file supplements mega-menu.css with mobile-specific fixes
   ========================================================================== */

/* ==========================================================================
   FIX: Ensure hamburger is always visible on mobile
   ========================================================================== */
@media (max-width: 768px) {
  /* Force hamburger visibility */
  .hamburger {
    display: flex !important;
    position: relative;
    z-index: 1005;
  }
  
  /* Ensure nav container doesn't hide hamburger */
  .nav {
    display: flex !important;
  }
  
  /* Hide desktop-only nav items */
  .nav__link,
  .nav__menu-trigger,
  .nav__cta {
    display: none !important;
  }
  
  /* Header layout fix */
  .header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 0.875rem 1rem !important;
    min-height: 56px;
  }
  
  /* Logo sizing on mobile */
  .logo {
    font-size: 0.75rem;
    gap: 0.5rem;
  }
  
  .logo__mark {
    width: 28px;
    height: 28px;
  }
  
  .beta-badge {
    font-size: 0.5rem;
    padding: 0.1rem 0.3rem;
  }
}

/* ==========================================================================
   FIX: Mobile nav z-index hierarchy
   ========================================================================== */
.mobile-nav-overlay {
  z-index: 1000;
}

.mobile-nav {
  z-index: 1002;
}

.hamburger {
  z-index: 1005;
}

/* ==========================================================================
   FIX: Smooth hamburger animation
   ========================================================================== */
.hamburger {
  /* Better touch target */
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

.hamburger span {
  will-change: transform, opacity;
  backface-visibility: hidden;
}

/* ==========================================================================
   FIX: Mobile nav scroll behavior
   ========================================================================== */
.mobile-nav {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Prevent body scroll when menu is open */
body.menu-open {
  overflow: hidden !important;
  position: fixed;
  width: 100%;
  height: 100%;
}

/* ==========================================================================
   FIX: Touch-friendly tap targets
   ========================================================================== */
@media (max-width: 768px) {
  .mobile-nav__link,
  .mobile-nav__close,
  .hamburger {
    min-height: 48px;
    min-width: 48px;
  }
  
  .mobile-nav__link {
    padding: 0.875rem 1rem;
  }
}

/* ==========================================================================
   FIX: Mobile nav link animations (reset when closed)
   ========================================================================== */
.mobile-nav:not(.active) .mobile-nav__link {
  animation: none;
  opacity: 1;
  transform: none;
}

/* ==========================================================================
   FIX: Safe area insets for notched devices
   ========================================================================== */
@supports (padding-top: env(safe-area-inset-top)) {
  .header {
    padding-top: max(0.875rem, env(safe-area-inset-top));
  }
  
  .mobile-nav {
    padding-top: max(5rem, calc(4rem + env(safe-area-inset-top)));
    padding-bottom: max(2rem, env(safe-area-inset-bottom));
  }
}

/* ==========================================================================
   ENHANCEMENT: Smoother transitions
   ========================================================================== */
.mobile-nav,
.mobile-nav-overlay {
  will-change: transform, opacity;
}

/* ==========================================================================
   ENHANCEMENT: Better visual feedback
   ========================================================================== */
.mobile-nav__link:active {
  background: rgba(255, 255, 255, 0.08);
  transform: scale(0.98);
}

.hamburger:active span {
  opacity: 0.7;
}

/* ==========================================================================
   FIX: Prevent layout shift
   ========================================================================== */
@media (max-width: 768px) {
  .header {
    contain: layout;
  }
}

/* ==========================================================================
   FIX: Mobile nav primary link styling
   ========================================================================== */
.mobile-nav__link--primary {
  /* Reset animation state for primary link */
  animation-delay: 0s !important;
}

/* ==========================================================================
   ENHANCEMENT: Better icon alignment
   ========================================================================== */
.mobile-nav__icon {
  display: flex;
  align-items: center;
  justify-content: center;
}
